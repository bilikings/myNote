# 顺序Linux中Select、poll、epoll的区别

+ select系统调用时用来让我们的程序监视多个文件句柄的状态变化的。程序会停在select这里等待，直到被监视的文件句柄有一个或多个发生了状态改变。

+ 相对于select来说，poll 也是在指定时间内论询一定数量的文件描述符，来测试其中是否有就绪的，不过，poll 提供了一个易用的方法，来实现 i/o 复用。

+ `epoll` 是Linux内核中的一种可扩展IO事件处理机制，最早在 Linux 2.5.44内核中引入，可被用于代替POSIX select 和 poll 系统调用，并且在具有大量应用程序请求时能够获得较好的性能（ 此时被监视的文件描述符数目非常大，与旧的 select 和 poll 系统调用完成操作所需 O(n) 不同， epoll能在O(1)时间内完成操作，所以性能相当高），epoll 与 FreeBSD的kqueue类似，都向用户空间提供了自己的文件描述符来进行操作。

### select的缺点

1. 单个进程可以监视文件的描述符存在最大限制，文件越多，性能越差。
2. 内核和用户态将存在空间内存拷贝问题，select需要复制大量的句柄数据结构
3. select返回的是含有整个句柄的数组，所以需要遍历才知道那些句柄发生了事件
4. select的触发方式是水平触发。

### poll

相比于select，poll使用链表来保存文件描述符，但是其他三个缺点仍然存在

# 什么是文件描述符

Linux中，一切皆文件

对于一个打开的文件，应用程序怎么使用它呢？文件描述符就诞生了。

> 文件描述符：当应用程序请求内核打开/新建一个文件时，内核会返回一个文件描述符用于对应这个打开/新建的文件，其fd本质上就是一个非负整数，读写文件也是需要使用这个文件描述符来指定待读写的文件

+ 不同进程中出现相同的文件描述符时，可能实际对应的文件并不是同一个，相反不同进程中不同的文件描述符也可可能对应同一个文件

+ 一个应用程序刚刚启动的时候，0是标准输入，1是标准输出，2是标准错误。如果此时去打开一个新的文件，它的文件描述符会是3。POSIX标准要求每次打开文件时（含socket）必须使用当前进程中最小可用的文件描述符号

  #### 文件描述符唯一性

  进程 + 文件描述符ID确认，因为内核为每个进程都有一份其所属的文件描述符表